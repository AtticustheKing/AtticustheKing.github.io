<html>
  <head>
    <title>PLACEHOLDER</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    
    <a href="./index.html">
  <button type="button" class="back_btn">Back</button>
      </a>
    
    <br>
    
    <canvas id="canvas" height="650" width="650"></canvas>
    
    <script>
      
      //SET UP
      var commandFrameCounter = 0
      var frame = 0
      var c = document.getElementById("canvas");
      var ctx = c.getContext("2d");
     
      function drawCanvas() {
        
      ctx.fillStyle = "#cccccc";
      ctx.fillRect(0, 0, 650, 650);
        
      }
      
      
      
      //ARROW KEYS and CONTROLLER
    
 var controller = {

  left:false,
  right:false,
  up:false,
  down:false,
  leftAttack: false,
  rightAttack: false,
  upAttack: false,
  downAttack: false, 
  t: false,
  y: false, 
      
  keyListener:function(event) {

    var key_state = (event.type == "keydown")?true:false;

    switch(event.keyCode) {

      
      case 65:// A
        controller.left = key_state;
      break;
      case 87:// W
        controller.up = key_state;
      break;
      case 68:// D
        controller.right = key_state;
      break;
      case 83:// S
        controller.down = key_state;
      break;
      case 37:// left arrow
        controller.leftAttack = key_state;
      break;
      case 38:// up arrow
        controller.upAttack = key_state;
      break;
      case 39:// right arrow
        controller.rightAttack = key_state;
      break;
      case 40:// down arrow
        controller.downAttack = key_state;
      break;   
      case 84://t
        controller.t = key_state;
      break;  
      case 89://y
        controller.y = key_state;
      break;    

    }

  }

};
     
      
      
      //PLAYER 
      
      
      var player_img = new Image();
      player_img.src = "https://kawaii.kawaii.at/img/solid-red-fabric-Robert-Kaufman-USA-Red-179485-1.JPG"
      
    var player = {
      height: 30,
      width: 30,
      x_speed: 0,
      y_speed: 0,
      x: 650/2,
      y: 650/2,
      attackSpeed: 1,
      attackCounter: 0,
      draw: function() {
      ctx.drawImage(player_img, this.x, this.y, this.width, this.height)
      }
    }
    
    //BULLET
    
    var bulletList = {} 
       
    
      function Bullet(id,x,y,x_speed,y_speed) {
        
        var bullet_img = new Image();
      bullet_img.src = "https://cdn.static-economist.com/sites/default/files/images/2014/06/blogs/babbage/20140628_stp501.jpg"
      
      var bullet = {
       x_speed: x_speed,
       y_speed: y_speed, 
       height: 10,
       width:10,
       x: x,
       y: y,
       id: id, 
       draw: function() { 
        ctx.drawImage(bullet_img, this.x, this.y, this.width, this.height)
       }
      }
     
     bulletList[id] = bullet;
        
        
      }
      
 //ENEMY     
      
      var enemyList = {} 
       
    
      function Enemy(id,x,y,x_speed,y_speed, width, height) {
        
        var enemy_img = new Image();
      enemy_img.src = "https://www.solidbackgrounds.com/images/2560x1440/2560x1440-blue-solid-color-background.jpg"
      
      var enemy = {
       spawnSpeed: 1,
       spawnCounter: 0, 
       x_speed: x_speed,
       y_speed: y_speed, 
       height: width,
       width: width,
       x: x,
       y: y,
       id: id, 
       draw: function() { 
        ctx.drawImage(enemy_img, this.x, this.y, this.width, this.height)
       }
      }
     
     enemyList[id] = enemy;
        
        
      }
      
    
 //UPDATE FUNCTION
      
      function update() {
        
       ctx.clearRect(0, 0, 650, 650);
        drawCanvas();
        playerUpdate();
        generateBullet();
        generateEnemy();
        frame++
        
        if (frame % 1 === 0){
         player.attackCounter += player.attackSpeed
         enemy.spawnCounter += enemy.spawnSpeed
        }
        
        if (frame % 20 === 0){
         commandFrameCounter++
        }
        
        for (var key in enemyList){        
         enemyUpdate(enemyList[key]) 
        }
        
        for (var key in bulletList){        
         bulletUpdate(bulletList[key]) 
        }
    
      }
      
      function bulletUpdate(something) {
       
        something.x += something.x_speed;
        something.y += something.y_speed;
        something.draw();
        
   
      }
      
      function enemyUpdate(something) {
       
        if (player.x > enemy.x) {
         enemy.x += enemy.x_speed 
        }
        
         if (player.x < enemy.x) {
         enemy.x -= enemy.x_speed 
        }
        
         if (player.y > enemy.y) {
         enemy.y += enemy.y_speed 
        }
        
         if (player.y < enemy.y) {
         enemy.y -= enemy.y_speed 
        }
        
        something.draw();
       
      }
      
      
      function generateEnemy() {
        if (enemy.spawnCounter > 300){
        var x_speed = 3;
        var y_speed = 3;
        var x = Math.random() * 650;
        var y = Math.random() * 650;
        var width = 20;
        var height = 20;
        var id = Math.random(); 
        Enemy(id,x,y,x_speed,y_speed, width, height);
        enemy.spawnCounter = 0
        }     
      }
    
      
      function generateBullet() {
        
         
       if (controller.upAttack && controller.downAttack === false && controller.leftAttack === false && controller.rightAttack === false) {
       if (player.attackCounter > 30){
         var x_speed = 0
       var y_speed = -5
       var x = player.x + 10
       var y = player.y - 5
       var id = Math.random();
       Bullet(id, x, y, x_speed, y_speed); 
         player.attackCounter = 0;
       }
        }
        
           if (controller.downAttack && controller.upAttack === false && controller.leftAttack === false && controller.rightAttack === false) {
       if (player.attackCounter > 30){
             var x_speed = 0
       var y_speed = 5
       var x = player.x + 10
       var y = player.y + 25
       var id = Math.random();
       Bullet(id, x, y, x_speed, y_speed); 
          player.attackCounter = 0;
       }
        }
        
           if (controller.rightAttack && controller.downAttack === false && controller.leftAttack === false && controller.upAttack === false) {
       if (player.attackCounter > 30){
             var x_speed = 5
       var y_speed = 0
       var x = player.x + 25
       var y = player.y + 10
       var id = Math.random();
       Bullet(id, x, y, x_speed, y_speed); 
              player.attackCounter = 0;
       }
        }
        
           if (controller.leftAttack && controller.downAttack === false && controller.upAttack === false && controller.rightAttack === false) {
       if (player.attackCounter > 30){
             var x_speed = -5
       var y_speed = 0
       var x = player.x - 5
       var y = player.y + 10
       var id = Math.random();
       Bullet(id, x, y, x_speed, y_speed);
       player.attackCounter = 0;
       }
        }
        
      }
      
      function playerUpdate() {
        
        
        
        if (controller.t === true && controller.y === true) {
          if (commandFrameCounter > 10){
         var command = prompt("Put command here:")
         commandFrameCounter = 0;
         controller.t = false  
         controller.y = false   
       
       switch(command) {
        
           case 'increase bullet speed':
               player.attackSpeed *= 2;
           break;
         default:
           confirm('sorry, that is not a command');     
       }}   
       }
        
       
        
        
        if (controller.up) {
          player.y_speed += -0.5 
        }
        
         if (controller.down) {       
            player.y_speed += 0.5           
        }
        
         if (controller.left) {      
            player.x_speed += -0.5
        }
        
         if (controller.right) {          
            player.x_speed += 0.5        
        }
        
     
       
        player.x += player.x_speed;
        player.y += player.y_speed;
        player.x_speed *= 0.9;
        player.y_speed *= 0.9;
        
        
        player.draw();
        
      }
      
       setInterval(function() { update()}, 20); 
     
                    
    
      window.addEventListener("keydown", controller.keyListener)
      window.addEventListener("keyup", controller.keyListener);
      
    </script>
  </body>
</html>
